-- Databricks notebook source
select count(*) from nielsenpos_store_sales_im.vw_dimension_store_tdlinx as stores
where customer_name like "%Targ%"

-- COMMAND ----------

select count(*) from nielsen_store_sales_im.vw_dimension_store_tdlinx as stores
where stores.subbanner_description like ("%Targ%")

-- COMMAND ----------

/* Working cell for Campbells Data extract */
select fact.store_tdlinx_id, fact.period, count(fact.upc) as upc_count, sum(float(fact.dollar_sales)) as dollar_sales, sum(fact.unit_sales), store.subbanner_description

from nielsenpos_store_sales_im.fact_store_sales as fact
  inner join nielsenpos_store_sales_im.vw_dimension_store_tdlinx as store on fact.store_tdlinx_id = store.store_tdlinx_id

where 
  fact.upc in ('085025100443','081692502150','081692502066','081692502118','081692502120','081692502027','085025100420','085025100424','085025100453','085025100497','085025100445','089176000297','089176000243','089176000262','089176000241','089176000275','001566522030','001566552080','001566577125','001566560100','001566577045','085025100401','085966100600','085025100407','085025100400','085025100402','085025100417','081692502000','081692502001','081692502002','001566500017','001566500019','081692502063','081692502062','001566522130','001566522060','001566560104','081692502087','081692502121','081692502157','081692502122','001566577046','001566525125','001566560915','081692502156','081692502155','081692502154','001566525007','081692502076','089176000296','081692502110','085025100479','085025100423','085025100403','089070400203','089070400202','089070400201','089070400220','089070400207','001566525126','081692502039','081692502088','081692502089')
  and date(fact.period) > date('2022-01-01')
  and store.subbanner_description like ("%Schn%")

group by fact.period, fact.store_tdlinx_id, store.subbanner_description
order by date(fact.period) desc

-- COMMAND ----------

/* Testing cell for Campbells Data extract */
select fact.store_tdlinx_id, fact.period, sum(float(fact.dollar_sales)) as dollar_sales, sum(fact.unit_sales) as unit_sales

from nielsenpos_store_sales_im.fact_store_sales as fact

where 
  fact.upc in ('005100002958','005100011285','005100000007','005100014757','005100002550','005100002554','005100002555','005100002556','005100002577','005100020472','005100020473','005100021518','005100022065','005100021224','005100021225','005100023282','005100023283','005100023284','005100023314','005100023315','005100023317','005100023318','005100023319','005100023320','005100000011','005100000524','005100000549','005100000550','005100000551','005100000554','005100000556','005100000562','005100000564','005100000568','005100000587','005100001021','005100001031','005100001081','005100001111','005100001127','005100001151','005100001161','005100001177','005100001231','005100001251','005100001261','005100001327','005100001347','005100001367','005100001437','005100001467','005100001527','005100001541','005100001621','005100001659','005100002141','005100002828','005100003234','005100003813','005100003885','005100004937','005100005887','005100005897','005100005937','005100005977','005100006197','005100006569','005100006959','005100011551','005100011552','005100011553','005100012327','005100012804','005100013458','005100013459','005100013736','005100013809','005100014292','005100014880','005100014919','005100014981','005100014982','005100015007','005100015076','005100016459','005100016461','005100016680','005100016721','005100016775','005100016777','005100016779','005100016780','005100017476','005100017547','005100017548','005100017639','005100018002','005100018035','005100018064','005100018723','005100019088','005100019570','005100019573','005100019575','005100019955','005100020399','005100020777','005100020778','005100020785','005100021230','005100021233','005100021239','005100021240','005100021242','005100021243','005100021280','005100021327','005100021330','005100021533','005100021586','005100021587','005100023262','005100025302','005100027687','005100027700','005100027701','004156500017','004156500024','004156514016','004156514116','004156514124','005260306503','005260306570','005260306580','005260306600','005260306601','005260306603','005260308200','005260304120','005260304180','005260304184','005260304255','005260304282','005260304283','005260304287','005260305400','005260305410','005260305414','005260305425','005260305429','005260305440','005260305444','005260305445','005260305450','005100001588','005100002548','005100002549','005100002794','005100002796','005100005043','005100009324','005100010546','005100012910','005100012911','005100017345','005100019517','005100019759','005100021221','005100022212','005100022744','005100022746','005100022747','005100027060','005100021762','005100021764','005100002379','005100010348','005100002421','005100002429','005100002431','005100012114','005100013279','005100014604','005100019879','005100021445','005100026934','005100027103','005100027104','005100000020','005100000067','005100000803','005100006992','005100012156','005100012157','005100012308','005100015278','005100015318','005100015339','005100015341','005100016983','005100016987','005100017100','005100017861','005100019240','005100019624','005100019625','005100020119','005100027621','005100027624','005100027626','005100027628','005100012573','005100012711','005100014426','005100015277','005100019323','005100020349','005100000285','005100001293','005100001047','005100001051','005100001601','005100001641','005100002457','005100006007','005100010526','005100012326','005100014293','005100014879','005100015283','005100021165','005100021231','005100021237','005100024637','005100024651','005100025301','004156500006','004156500019','004156500027','004156500029','004156500058','004156514024','004156514216','004156519311','004156522741','005100001214','005100005044','005100026977','005100027013','005100002402','005100010349','005100018806','005100000004','005100000284','005100000336','005100000366','005100004285','005100013801','005100013803','005100015315','005100017085','005100020788','005100021738','005100012773','005100013062','005100021697','005100022195','005100002858','005100022439','005100002558','005100022432','005100000618','005100001166','005100001187','005100001617','005100001767','005100002107','005100002588','005100008723','005100013737','005100016053','005100016681','005100018034','005100019948','005100020825','005100021885','005100023258','005100027477','005100027829','004156500007','004156500008','004156519388','005100025207','005100021919','005100021920','005100021921','005100021922','005100024954','005100025075','005100025076','005100025078','005100027223','005100001210','005100019856','005100021763','005100021905','005100022438','005100002366','005100014297','005100015634','005100016887','005100016888','005100022463','005100022464','005100014331','005100015325','005100018866','005100018867','005100020195','005100020345','005100020346','005100020355','005100026954','005100026955','005100026956','005100014412','005100021259','005100012938','005100021241','005100027357','005100027358','005100027557','004156500009','004156527183','005100019532','005100022391','005100027015','005100021446','005100011977','005100022894','005100024504','005100014756','005100021590','005100021591','005100021908','005100021911','005100021913','005100021914','005100021916','005100021917','005100023341','005100012939','005100014877','005100014878','005100016903','005100017520','005100018648','005100019568','005100019571','005100019578','005100021164','005100021244','005100021886','005100023177','005100023266','005100023345','005100023404','005100023405','005100023406','005100024505','005100024508','005100024632','005100024633','005100024634','005100024635','005100025034','004156519869','005260306434','005260306437','005260306500','005260306504','005260304094','005260304096','005260304097','005260304281','005260305435','005260305436','005260305461','005260305462','005260305464','005260305468','005260305472','005260305473','005260305474','005260305487','005260305488','005260305489','005260305490','005260305491','005260305492','005260305493','005260305494','005260305521','005260305522','005260305523','005260305560','005260305561','005260305562','005260305563','005260305564','005260305606','005260305607','005260305615','005260305630','005260305631','005100002799','005100019530','005100024920','005100025029','005100025031','005100027014','005100027746','005100004156','005100014296','005100015635','005100019880','005100021451','005100026792','005100016985','005100026843','005100026844','005100026923','005100027504','005100021890','005100024762','005100024781','005100027333','085832820449','005100002563','005100015547','005100015548','005100006187','005100023178','005100025153','005100025268','005100025270','005100025271','005100025274','005100026916','005100027153','005100027154','005100027558','005260306604','005260304170','005260305525','005260305526','005260327763','005260327764','005260327765','005100001598','005100021220','005100025032','005100027622','005100027635','005100027636','005100027653','005100027654','005100027655','005100002639','005100002430','005100027710','005100027711','005100017682','005100027007','005100016150','005100021331','005100023089','005260304100','005100025275','005100019244','005100023228','005100027098','005100027100','005100024856','005100024858','005100003868','005100012968','005100016904','005100024868','005100025123','005100025154','005100025304','005100027106','005100027108','004156514598','004156515108','004156523398','004156523399','005260308225','005260308300','001410009435','001410009507','005100020655','005100021696','005100014997','005100021887','005100024650','005100025300','005100026759','005100027608','005100027609','005100022211','005100021450','005100022832','005100016776','005100021229','005100023347','005100027343','005260306100','005260304279','005260305467','005260305469','005260304086','005260305466','005260305605','005260305617','005260305619','005100027012','005100002025','005100000660','005100000683','005100012131','005100023403','005100025303','004156526894','005100024890','005100018596','005100020820','005100023316','004156514164','005260305612','005100025158','005100022444','005100022446','005100022448','005100022450','005100024721','005100012842','005100027607','004156500057','004156514064','005260306507','005260306510','005260306550','005100025027','005100021449','005100024734','005260306595','005260305030','005260305441','005100022816','005100022535','005100006017','004156524612','005100015904','005100022929','005100022930','005100022927','005100023281','005100022425','005100022427','005100022428','005100022429','005100022434','005100022436','005100000016','005100013338','005100001266','004156500067','004156500068','005100023387','005100024733','005100021232','005100024922','005100027785','005100027786','005100023355','005100023340','005100026823','005100023344','005100027011','005100024891','005260306751','005260306597','005260305640','005100017723','005100021226','005100026922','005260309469','005260309479','005100021301','005100002520','005100021398','005100004244','005100014370','005100020050','005100020051','005100020054','005100020059','005100021166','005260305477','005260305503','005100021380','005100021381','005100021387','004156521845','005100001036','005100001256','005100013271','005100021228','005100021416','005100024921','005100020644','005100013272','005100020776','005100023104','005100023105','005100027686','005100022551','005100025102','005100025103','005100027326','005100027327','005260306750','005260306752','005260309506','005260309507','005260306505','005260305399','005260305428','005260305431','005260305566','005260305568','005260305570','005260305610','005260305611','005260305613','005260305641','005100015905','005100018108','005100002553','005100016421','004156516733','004156516734','005100002511','005100002792','005100013281','005100002523','005260306602','005100025293','005100020475','005100022134','005100022135','005100022284','005100024602','005100021408','005100021409','005100021410','005100021411','005100022021','005100022518','005100024782','005100001026','005100001221','005100001236','005100019565','005100019569','005100019947','005100020661','005100021227','005260306650','005260306652','005260306571','005260309060','005260309491','005260305506','005260305635','005260305636','005100025077','005100027802','005100021390','005100022831','005100027151','085832876223','085832876224','005100018560','005100002422','005100023184','004156527359','004156527379','004156526895','005100027518','005100025317','005100024541','005100024542','005100024543','085832876112','085832876130','085832876154','085832876212','085832876218','005100022255','004156500037','004156500038','005100020653','005100008725','085832876142','005260306436','005100026814','005100022437','004156514999','005260304088','005100022433','005100022435','004156518982','005100027849','005100027850','001410007230','001410009436','005100023012','005100022635','004156522023','005100002413','005100016982','001410007231','005100019620','005100019621','005100020176','005100014653','005100015855','005100014655','004156516735','005100002373','005100027101','004156522743','005260309070','005260305601','005100024857','005100000203','005100000210','005100010061','005100014871','005100014916','005100021892','005100024718','005100024719','005100024720','005260306575','004156527682','004156527683','004156527684','004156527789','004156528078','004156528079','005100028009','005100028010','005260308325','005260306653','005260309505','005260309482','005260309483','005260309484','005260309461','005260309462','005260309463','005100019069','005100021399','005100012495')
  and date(fact.period) > date('2019-07-01')
  and fact.store_tdlinx_id in ('7594700','1904640','1612610','0364234','0891335','0782669','0983488','7078406','0486648','7436483','0983405','1595988','1457912','0891344','2571960','1734520','1784074','0505494','0383961','3769634','0485062','0506845','1872066','3641802','0505492','0505517','0794614','2571993','0544241','3784907','2056068','0932965','0541630','2030181','1877931','2153548','1904659','0364315','0364335','0364296','L339363','1513355','7615128','7414458','0364339','7483681','0485845','0790188','2571891','0364321','0506878','0485806','1746142','7322256','1513319','3921827','1479292','0506498','1479382','2233813','2233701','0505526','2233913','0969513','1778828','0486647','1904646','0553278','0383793','3491918','7479340','1851788','3627688','0583035','0897133','0364310','0364197','1596620','0883284','2230480','0485838','7552134','1851800','0485774','1851791','0543918','0543411','1479311','0941050','0544240','0794619','0908470','0506839','1636761','2028136','0485610','1851725','1904664','7344702','0364395','0884422','0941052','2191384','0505558','0364270','2056200','1596408','0485946','0485582','0544314','1904661','1678576','1680805','0555098','0364254','2250892','1759757','0120127','2228058','2636318','0954606','0485888','2056072','0364393','0794617','0485605','0485060','0505522','2056943','1678606','0790193','1734602','0506840','0530048','1746113','0582419','0913897','3864062','0553943','0506876','7231484','1596587','0505536','0503534','0545440','1568694','0364237','0983529','2173251','3641767','1745989','1636771','1831123','3562686','0064556','1760631','1971383','0485834','2635539','2233767','2635902','0790180','2288621','0486625','1746112','1904647','1904663','1479316','0794620','0486644','0364201','0954610','2056047','2154944','0484906','1612568','0514019','0544153','0790172','7615122','1950586','1831132','2250969','2636276','0983401','0977937','2251035','7596205','0514013','2230415','0364221','0776566','1877403','3983127','0954608','0364205','1479248','0969541','0544233','1479305','0790190','0996072','0581639','0364200','1457938','1457932','0364229','0485903','0983386','1754478','2063892','1904658','0485672','2019169','2635896','1904681','1868913','3513075','1678520','0506867','0845580','2233695','1877859','2251025','0505554','0383225','0583030','0983505','1976594','2154735','1734695','0485849','0913873','2636291','1745995','0505486','1950646','0485843','0364196','1760701','3562022','1678537','1759429','1759755','1793032','7292891','2572014','0364233','0485952','2057100','0484907','0485804','0983525','2636120','1778805','2250970','3563033','0969508','2571896','1568057','2233655','1609795','0983518','0364279','7343757','2636247','0583049','0579801','0983490','2635785','1457909','0581636','0485599','0969548','1904651','1678575','1735556','1877821','0505544','0582417','1479301','2250924','7037771','1636757','1779617','0484944','2019100','0568981','0983481','0485818','1793019','0583062','0583059','0865171','7414533','1568056','1457907','2636320','0486687','0897101','0539067','7414520','0941003','2054063','1829721','3641718','1678600','1904656','1793033','0563342','0485816','2154791','0969539','0506846','0505524','0969534','0364394','0007205','1513323','0583046','1793027','1851710','1568053','1734741','0513932','0506854','0554085','0584187','1769020','2153787','0485824','1904650','2250983','2571885','0544191','2233924','2124157','0485583','1904648','1759658','1491729','0515913','1868899','0364350','2636253','1759205','0513934','0505508','1902974','2153815','0519102','0555091','0571880','7231494','0420745','0583064','1759441','2019077','0543401','0996062','0485007','1678607','7189036','0790173','0898454','3602822','0941046','0919338','0913874','2250978','0364276','0486608','1612553','0932959','0553966','0996070','1568037','1746146','0485813','3774819','2056378','2636308','3641702','0506848','1596434','0513929','0485069','0790171','1904634','0485074','7436410','0995837','0485896','0983535','0996074','0373681','2056268','1568703','0576562','0364253','3563015','0485620','0485947','0485955','1479290','1760686','0364308','1734766','1568033','0364249','7552130','0485948','1678383','0544230','1678608','0486669','7322298','0704459','1734720','1877841','1971477','1568721','2056002','2033244','1903007','2155043','2233731','2233931','1868867','0913883','1636762','2056780','3641518','0529259','0485893','1868862','0969530','1873782','0364388','0485821','0969519','3593023','2047648','0485852','1678602','0002417','7326136','1596392','7077869','0897102','1491731','0583043','0969536','0543919','0485820','1759421','0505563','4038128','7267866','7552085','0418283','0364334','0484886','1568729','1904669','2154909','7322301','0794635','1449572','2056030','1735572','0884427','0485028','1759436','0697065','0932966','7343696','1755367','0485035','2019116','2231154','7608136','0364198','1479232','2250997','0544261','1636745','1596442','1851786','2056064','2250911','0907523','3193055','0897132','7539824','7395687','0941008','0941054','0790170','2048100','2138317','0485773','1904636','3641805','2233905','1715733','0364266','2636268','0484877','1793021','1529489','7548260','2571956','0485854','0790176','0995283','1636758','2057014','1457955','1636746','0543469','1612598','0583023','0364245','0932939','1457906','1755005','2056310','0485037','0577035','7414455','0485944','0794638','0571887','0486640','0896770','0529256','0940996','1851719','0330853','0883305','0485036','2137804','1851799','1851787','2025712','0485953','2636139','0712431','3562059','0884436','1479239','0896902','3193083','3641764','1596360','1904652','1773509','3641824','3193107','2153696','2033547','0505534','0554099','1612562','0364337','2571907','0891333','0486655','0529260','2233667','1568584','0932945','0505503','1746116','0485608','0880778','0560524','2571901','2230894','1596387','0868340','1759235','0969514','1759289','2057102','7557597','7552081','0420186','7014417','0485065','0486656','0485803','1636748','0485941','1678585','0364331','2636241','0506499','0884434','0505556','0543496','0485847','2154750','2571879','2154214','2057076','1759228','1678514','1746128','1678543','0364293','2468926','0485822','0485949','0485942','0506874','1976411','0485643','1877822','1904655','0484959','0364252','1868819','2233808','1760615','0969552','0555083','2250986','0336307','2056023','2137740','0529257','0868337','1778833','1457915','0868327','2233880','1904649','1457933','0505545','0794616','0790195','1746131','0364225','0505565','2153833','0364317','0486611','1904657','3562652','1950570','1596364','0543921','0543511','0484844','0485573','0485892','3193111','0364341','1678519','0790168','0485611','1734588','2139250','1596648','2019273','2571918','0583037','1678525','0544277','1678540','1904639','1851698','0581476','0364232','0571263','0941011','0364194','0485905','0544342','0382680','0506850','0364307','7014405','3565057','1612600','0996071','0954592','1609796','0978058','0883290','0484900','0896882','0485051','0485678','2138812','1612571','7553927','1568669','0954575','1851747','0494573','0485776','1678566','1678518','0485810','0983403','1851806','3562875','1950579','1793030','0505571','1877477','0996060','2138746','1735580','0364246','0868352','1513340','1513316','7343753','1596376','0897122','0340727','0485894','3864042','1596402','7521113','0485829','1745987','3784881','2233840','1760732','3561994','0877524','2154972','0364336','3562132','0418294','0913847','0996076','1760681','7614161','7574414','0543404','0573842','0542969','0969522','0485940','1877846','1734711','2251007','1479296','2572045','1568039','0485848','2155107','2124173','2191401','0561936','1746124','1636752','0969531','1851789','1457936','0453810','0434071','2154046','2250948','0790197','1678599','2250942','0941007','2059834','3930230','3193038','1612591','1746143','1609801','2230437','0369578','1596370','0364286','0983534','0574132','0485589','0364397','1734698','0531655','0883279','1568048','7414541','1596423','0419411','0364326','1612556','0505542','0794634','1830999','0364386','1457934','0896756','1868919','1678532','0506875','0891340','0897110','0506836','1787608','1678527','1868894','2719556','0983409','0899459','1746154','0868359','7381066','0364376','1851751','1745967','0485904','1760678','0506863','2571973','1778837','1457943','1568542','1830774','1877440','0505512','0563937','0382810','2056380','3889526','0485679','2196460','3185748','0555033','1851790','1612551','2572025','0561200','0553993','2230808','3930365','1830784','2154895','1854379','7538164','2635550','7621037','7047218','0555026','0575550','0485851','2250975','0485839','7552473','0954580','7552078','2138842','0583042','0572068','1513350','1613100','1596436','2190978','0941029','3641652','0897127','0543475','1851803','1513334','7381083','1479289','2571996','2288623','2154093','0571892','0913901','3593034','0486650','1793022','0571883','0983463','0506849','0941004','2572012','1830954','0543506','0940998','1877475','0529261','3851430','3193057','0418258','1851715','7178712','1834616','0954570','0364340','1793066','0794629','2057086','2233753','0542821','0529262','1904670','7607946','3563094','0794622','0485897','0364195','7037379','1831126','0364380','2060437','1872078','0484942','1851720','1851757','7414544','1568052','1728170','2250973','1596378','0505528','0897121','2056053','2572023','0897104','0506843','1877577','2572057','0485936','1755716','0506877','7594696','0941001','1607209','0913890','1479388','2191405','1793018','0896781','0484913','0790177','2154985','1834597','0790166','0486637','2056835','0897125','3563128','0386868','1596429','0485886','0364332','0913886','0364313','2233745','0485938','1568718','2636309','1636766','1778794','1678379','0983466','7553932','0123781','0364346','0484983','7552079','0573011','7037314','0913905','1868898','0883283','1831134','0555099','1877625','1595991','0382422','0544177','0896764','0506872','0364398','0932963','1904671','0884439','0364303','0790178','1734667','0505559','0485889','2019230','3193033','0583066','0486654','0868341','2056081','2572043','1692312','1479307','2056385','1877689','0019753','2056908','0544173','0499940','1457939','1793065','1636707','1678580','0506859','1877486','2057037','3888999','0543408','0418286','0983396','0485853','2635985','3774303','0555109','2019191','2019385','0364269','2155118','7614128','1612621','0506871','5060695','2137825','0486667','2233759','0583061','2233795','0570803','0868345','0505516','7436402','7572298','0543332','0485585','2233917','0455472','7231307','1760632','1851726','0583053','0505985','0969525','0996081','2191334','3193097','2636313','1612606','3942265','2250991','0505550','1457235','1746120','1851717','0913888','1479293','1793017','2124238','0932957','1831038','1877744','3641906','1787783','1457928','0514007','3193134','1759753','0583057','1479313','0582489','0969506','2019325','2138762','3889523','1904654','1868906','1457916','0794631','2233866','0891350','1778817','0505514','0485603','3193093','1596379','0115685','2155018','0571891','0932960','1771973','2025733','0896775','7037550','0535667','0583044','0576047','0794624','2571966','1612549','3617739','7414507','2056343','1609798','0485019','0364251','1568059','0543416','2056037','7615120','3193024','0505531','0486614','2233775','1734773','0364268','1596443','1904662','0485013','0486658','7592780','0364275','1829722','1568568','7594685','1868815','0941005','0485601','2233787','2019288','0794618','7322302','0318816','0897128','1903106','0983469','1745990','2155013','0969556','0485770','0969551','1479300','1596345','0514002','3193113','2059858','3851559','0573085','1971549','0896919','1479286','5249165','0364301','0364344','2571916','1904682','2233860','0484891','1678521','2056539','0485836','2063900','1877716','0941049','0505496','0897129','7188824','0365758','2636295','1904660','0790199','2233852','2191325','0364210','0484894','0544244','0914307','2250833','0543474','0535628','7611453','7577224','1950598','0364273','0364282','0484859','0323882','7607951','0884423','1596411','7292901','1734785','0485675','0364260','0707342','0485026','1678558','1734799','7594702','0514026','1904637','0486638','1568055','0364345','0523105','2572010','0897130','1746105','7267816','1479392','1746099','7292902','3641626','1678546','0897126','0486651','0384096','0544316','0941009','1868844','1513330','7267791','1479287','1735410','0485673','0575553','0484963','1851801','1568672','0505538','0884435','0499842','0485850','1479320','0794627','1612596','3193074','1479251','0983377','0405209','0790182','0913877','1759445','0505520','0790174','1612604','0364236','1457917','0523121','2572041','0485844','1612611','2153702','0484903','1831125','0983504','1904641','1904665','0506866','1793029','2251029','1851755','0996078','1971530','0485613','0583055','0544181','1760605','2154814','1479246','0903457','0954597','0583052','3573765','2233878','7436504','2153496','3889985','7020193','1760698','0941047','7521072','1479235','2230748','0535624','0364342','0954582','1734804','0996067','2154655','0484848','2054066','0983495','1877722','3193123','1851723','0794636','1457960','1522805','0484887','0485935','1692279','2571898','0424477','1479391','3851420','1904638','7552126','0364306','1457959','0969547','1636755','3514884','0794632','0543479','0553810','0583060','0485027','1636778','L114477','0542946','3193096','7436137','0576049','0913879','0571888','0543505','1734622','0983480','1826424','0954579','0117367','1851805','1851711','2635998','0539063','1759439','0794626','0544264','1479370','3563111','2233843','2636053','7188877','0505529','1851714','1678598','2045825','1803471','1976441','0505501','0555037','1904674','2233707','0543464','7267848','2137625','0484875','1904644','0364343','0513930','0485835','1831129','0940999','0670707','0539064','3784887','0554063','1734654','0806723','3889341','7693434','1868780','1851754','0364241','1760690','1678523','0506852','3812677','0912075','0484880','0364299','2154237','0364305','0485581','7014380','0954612','7292898','0338613','1734792','0544285','1678588','1636708','0505506','0486645','0364333','1568562','1513359','1868890','1636786','0485900','1596404','0505561','1903009','2153805','7267857','0513997','3784274','0896767','0485626','0583032','0364247','1908226','2233698','0983517','3921780','0784363','0364272','0364264','0932969','2153666','2060333','1902969','0903527','0364226','0364302','1678382','0954587','1976572','1457957','1793047','1950543','1868853','3627759','1904645','2636245','3497116','0790184','1734754','0535590','0011029','0897118','1568040','0485792','0485623','2154067','0513935','0485901','0383790','0420156','7395684','1479302','5170229','7014393','1793028','2191375','2572051','0364390','0983485','1851713','0983464','1972173','0505488','0364278','1746152','1903066','3784490','2636270','7014430','0571890','0790179','0484952','2153743','0485823','0485909','0543406','0485937','0544243','2030278','1596580','0567043','0500215','0505569','0364320','3930304','1596396','7621042','0364309','1735402','0364277','2065592','1596341','0364392','1568038','1568549','0554889','7512746','1513338','0574128','1877842','1793070','2056060','0794625','0555081','1612618','2635919','7343775','2019391','7168641','2635955','1950637','0364271','0485895','1596438','1479377','7395682','1595999','0574127','0969557','0484882','7395683','0486619','1851727','1868838','0996268','0485081','1568724','2635931','0555024','7381076','0572161','2019204','1760708','2571925','0913895','0529258','2571923','0883295','1760640','1636754','0364261','3193129','0364244','3983154','1826423','2054064','0996065','0364287','0941010','0794621','2153719','0868332','1612609','0527594','0891354','0513931','0485054','0555047','1971436','0983397','1793016','7479214','1734631','0485841','3193014','0896943','0418674','1831018','1950540','0485050','1457930','2571974','0896909','0932938','0484881','0543455','1825217','1831127','0364209','7538148','0364348','0364351','0485619','2155075','0364362','1596636','0505552','2153453','2571975','1678554','0932962','0505518','3563119','0364193','7562707','1513336','1904675','1904672','0932964','1734790','2062853','0513991','0364256','2571968','7037250','0506847','0583065','0364349','2636146','2019399','0932967','3193082','1904653','1457956','0790181','1636783','0884433','2233900','0364204','1596412','1745984','0575417','2636143','3563134','1786878','0896900','3193020','0983394','1479324','1760617','2138351','0513933','1612594','1793025','0382864','0940997','1513341','1457927','1678534','2153563','0542890','0868351','0946985','0543922','3193075','1568054','2137764','3930310','0506835','2571983','2030172','0486653','0562964','1568555','2251016','0364230','0364399','1595980','0884429','0583026','0384113','2054061','0505540','0364358','1479295','1636781','0913892','1746103','0883276','0983501','0794633','0720058','2032169','1868922','2571875','0485950','0559786','0379272','3641603','2230937','2022256','1513328','0553263','3889498','7231434','0364396','2636304','1678547','1778830','1609797','7267829','0435076','0485769','0364255','1868874','1868800','1734702','0486662','2019337','0364207','1479323','2572030','0505509','1636772','2154053','0485038','0941017','0583051','0891334','0485609','1734779','0486713','0969517','1868771','0505579','0790175','1759239','1596000','1568677','2635982','3589297','1678582','0486677','0369486','0485080','1678609','2019310','0572661','0954615','0364314','1793067','1905783','2251011','0364325','1868822','2251020','7037505','0505574','1678578','0579536','0546114','0790169','0364330','7267836','0505489','0983538','0386781','1902966','0996069','0790167','0600544','0880774','0364347','0513988','2571992','2250981','0486635','1851760','0485029','1972158','1609799','3193040','0583050','2019057','0513994','0424879','1746122','0485846','1678512','1877838','7267840','7436495','1868910','1678586','1745994','0932950','2231143','0884438','7538150','0996082','1822454','1760735','0505547','0364250','2155092','0583040','2612067','2048287','0485676','2636259','0486609','0364322','0383850','2571876','2054069','3561972','0505510','0573577','1759767','0943501','1745968','0506855','1746144','2019218','3930269','2233831','1851697','0484904','0932936','1596441','2251027','0485625','2056975','0550538','2571991','1596440','1491726','0057630','0485782','0581614','0544242','7414538','7604263','2233888','0364316','1596344','0913870','0543396','0486646','0896944','1971501','0485830','2153679','2635992','0364304','0576072','0118208','1760635','7037392','0896940','1804265','1479314','1568042','0927170','7591793','3784894','1746110','2233873','0514023','1904683','2251022','0940995','0794623','0913848','0529255','1568032','0560419','1636751','1868832','1513331','2571955','0897113','0794630','1612622','1513321','2153474','1636767','1785054','1760718','3784898','2025742','0364323','0364352','2233892','0364292','2636297','2571963','3193031','1513363','2025662','0485939','2057053','1830928','2153519','0369933','0504013','7521118')

group by fact.store_tdlinx_id, fact.period

-- COMMAND ----------

SELECT fact.*, store.* FROM nielsenpos_store_sales_im.fact_store_sales as fact
INNER JOIN nielsenpos_store_sales_im.vw_dimension_store_tdlinx as store ON fact.store_tdlinx_id = store.store_tdlinx_id
WHERE
  fact.store_tdlinx_id = '7594700'
  AND fact.upc = '005100015904'

-- COMMAND ----------

SELECT fact.*, store.* FROM nielsenpos_store_sales_im.fact_store_sales as fact
WHERE
  fact.store_tdlinx_id = '7594700'
  AND fact.upc = '005100015904'

-- COMMAND ----------

/* Testing cell for Campbells Data extract */
select fact.store_tdlinx_id, fact.period, sum(float(fact.dollar_sales)) as dollar_sales, sum(fact.unit_sales) as unit_sales
  

from nielsenpos_store_sales_im.fact_store_sales as fact
  inner join nielsenpos_store_sales_im.vw_dimension_store_tdlinx as store on store.store_tdlinx_id = fact.store_tdlinx_id

where 
  fact.upc in ('005100002958','005100011285','005100000007','005100014757','005100002550','005100002554','005100002555','005100002556','005100002577','005100020472','005100020473','005100021518','005100022065','005100021224','005100021225','005100023282','005100023283','005100023284','005100023314','005100023315','005100023317','005100023318','005100023319','005100023320','005100000011','005100000524','005100000549','005100000550','005100000551','005100000554','005100000556','005100000562','005100000564','005100000568','005100000587','005100001021','005100001031','005100001081','005100001111','005100001127','005100001151','005100001161','005100001177','005100001231','005100001251','005100001261','005100001327','005100001347','005100001367','005100001437','005100001467','005100001527','005100001541','005100001621','005100001659','005100002141','005100002828','005100003234','005100003813','005100003885','005100004937','005100005887','005100005897','005100005937','005100005977','005100006197','005100006569','005100006959','005100011551','005100011552','005100011553','005100012327','005100012804','005100013458','005100013459','005100013736','005100013809','005100014292','005100014880','005100014919','005100014981','005100014982','005100015007','005100015076','005100016459','005100016461','005100016680','005100016721','005100016775','005100016777','005100016779','005100016780','005100017476','005100017547','005100017548','005100017639','005100018002','005100018035','005100018064','005100018723','005100019088','005100019570','005100019573','005100019575','005100019955','005100020399','005100020777','005100020778','005100020785','005100021230','005100021233','005100021239','005100021240','005100021242','005100021243','005100021280','005100021327','005100021330','005100021533','005100021586','005100021587','005100023262','005100025302','005100027687','005100027700','005100027701','004156500017','004156500024','004156514016','004156514116','004156514124','005260306503','005260306570','005260306580','005260306600','005260306601','005260306603','005260308200','005260304120','005260304180','005260304184','005260304255','005260304282','005260304283','005260304287','005260305400','005260305410','005260305414','005260305425','005260305429','005260305440','005260305444','005260305445','005260305450','005100001588','005100002548','005100002549','005100002794','005100002796','005100005043','005100009324','005100010546','005100012910','005100012911','005100017345','005100019517','005100019759','005100021221','005100022212','005100022744','005100022746','005100022747','005100027060','005100021762','005100021764','005100002379','005100010348','005100002421','005100002429','005100002431','005100012114','005100013279','005100014604','005100019879','005100021445','005100026934','005100027103','005100027104','005100000020','005100000067','005100000803','005100006992','005100012156','005100012157','005100012308','005100015278','005100015318','005100015339','005100015341','005100016983','005100016987','005100017100','005100017861','005100019240','005100019624','005100019625','005100020119','005100027621','005100027624','005100027626','005100027628','005100012573','005100012711','005100014426','005100015277','005100019323','005100020349','005100000285','005100001293','005100001047','005100001051','005100001601','005100001641','005100002457','005100006007','005100010526','005100012326','005100014293','005100014879','005100015283','005100021165','005100021231','005100021237','005100024637','005100024651','005100025301','004156500006','004156500019','004156500027','004156500029','004156500058','004156514024','004156514216','004156519311','004156522741','005100001214','005100005044','005100026977','005100027013','005100002402','005100010349','005100018806','005100000004','005100000284','005100000336','005100000366','005100004285','005100013801','005100013803','005100015315','005100017085','005100020788','005100021738','005100012773','005100013062','005100021697','005100022195','005100002858','005100022439','005100002558','005100022432','005100000618','005100001166','005100001187','005100001617','005100001767','005100002107','005100002588','005100008723','005100013737','005100016053','005100016681','005100018034','005100019948','005100020825','005100021885','005100023258','005100027477','005100027829','004156500007','004156500008','004156519388','005100025207','005100021919','005100021920','005100021921','005100021922','005100024954','005100025075','005100025076','005100025078','005100027223','005100001210','005100019856','005100021763','005100021905','005100022438','005100002366','005100014297','005100015634','005100016887','005100016888','005100022463','005100022464','005100014331','005100015325','005100018866','005100018867','005100020195','005100020345','005100020346','005100020355','005100026954','005100026955','005100026956','005100014412','005100021259','005100012938','005100021241','005100027357','005100027358','005100027557','004156500009','004156527183','005100019532','005100022391','005100027015','005100021446','005100011977','005100022894','005100024504','005100014756','005100021590','005100021591','005100021908','005100021911','005100021913','005100021914','005100021916','005100021917','005100023341','005100012939','005100014877','005100014878','005100016903','005100017520','005100018648','005100019568','005100019571','005100019578','005100021164','005100021244','005100021886','005100023177','005100023266','005100023345','005100023404','005100023405','005100023406','005100024505','005100024508','005100024632','005100024633','005100024634','005100024635','005100025034','004156519869','005260306434','005260306437','005260306500','005260306504','005260304094','005260304096','005260304097','005260304281','005260305435','005260305436','005260305461','005260305462','005260305464','005260305468','005260305472','005260305473','005260305474','005260305487','005260305488','005260305489','005260305490','005260305491','005260305492','005260305493','005260305494','005260305521','005260305522','005260305523','005260305560','005260305561','005260305562','005260305563','005260305564','005260305606','005260305607','005260305615','005260305630','005260305631','005100002799','005100019530','005100024920','005100025029','005100025031','005100027014','005100027746','005100004156','005100014296','005100015635','005100019880','005100021451','005100026792','005100016985','005100026843','005100026844','005100026923','005100027504','005100021890','005100024762','005100024781','005100027333','085832820449','005100002563','005100015547','005100015548','005100006187','005100023178','005100025153','005100025268','005100025270','005100025271','005100025274','005100026916','005100027153','005100027154','005100027558','005260306604','005260304170','005260305525','005260305526','005260327763','005260327764','005260327765','005100001598','005100021220','005100025032','005100027622','005100027635','005100027636','005100027653','005100027654','005100027655','005100002639','005100002430','005100027710','005100027711','005100017682','005100027007','005100016150','005100021331','005100023089','005260304100','005100025275','005100019244','005100023228','005100027098','005100027100','005100024856','005100024858','005100003868','005100012968','005100016904','005100024868','005100025123','005100025154','005100025304','005100027106','005100027108','004156514598','004156515108','004156523398','004156523399','005260308225','005260308300','001410009435','001410009507','005100020655','005100021696','005100014997','005100021887','005100024650','005100025300','005100026759','005100027608','005100027609','005100022211','005100021450','005100022832','005100016776','005100021229','005100023347','005100027343','005260306100','005260304279','005260305467','005260305469','005260304086','005260305466','005260305605','005260305617','005260305619','005100027012','005100002025','005100000660','005100000683','005100012131','005100023403','005100025303','004156526894','005100024890','005100018596','005100020820','005100023316','004156514164','005260305612','005100025158','005100022444','005100022446','005100022448','005100022450','005100024721','005100012842','005100027607','004156500057','004156514064','005260306507','005260306510','005260306550','005100025027','005100021449','005100024734','005260306595','005260305030','005260305441','005100022816','005100022535','005100006017','004156524612','005100015904','005100022929','005100022930','005100022927','005100023281','005100022425','005100022427','005100022428','005100022429','005100022434','005100022436','005100000016','005100013338','005100001266','004156500067','004156500068','005100023387','005100024733','005100021232','005100024922','005100027785','005100027786','005100023355','005100023340','005100026823','005100023344','005100027011','005100024891','005260306751','005260306597','005260305640','005100017723','005100021226','005100026922','005260309469','005260309479','005100021301','005100002520','005100021398','005100004244','005100014370','005100020050','005100020051','005100020054','005100020059','005100021166','005260305477','005260305503','005100021380','005100021381','005100021387','004156521845','005100001036','005100001256','005100013271','005100021228','005100021416','005100024921','005100020644','005100013272','005100020776','005100023104','005100023105','005100027686','005100022551','005100025102','005100025103','005100027326','005100027327','005260306750','005260306752','005260309506','005260309507','005260306505','005260305399','005260305428','005260305431','005260305566','005260305568','005260305570','005260305610','005260305611','005260305613','005260305641','005100015905','005100018108','005100002553','005100016421','004156516733','004156516734','005100002511','005100002792','005100013281','005100002523','005260306602','005100025293','005100020475','005100022134','005100022135','005100022284','005100024602','005100021408','005100021409','005100021410','005100021411','005100022021','005100022518','005100024782','005100001026','005100001221','005100001236','005100019565','005100019569','005100019947','005100020661','005100021227','005260306650','005260306652','005260306571','005260309060','005260309491','005260305506','005260305635','005260305636','005100025077','005100027802','005100021390','005100022831','005100027151','085832876223','085832876224','005100018560','005100002422','005100023184','004156527359','004156527379','004156526895','005100027518','005100025317','005100024541','005100024542','005100024543','085832876112','085832876130','085832876154','085832876212','085832876218','005100022255','004156500037','004156500038','005100020653','005100008725','085832876142','005260306436','005100026814','005100022437','004156514999','005260304088','005100022433','005100022435','004156518982','005100027849','005100027850','001410007230','001410009436','005100023012','005100022635','004156522023','005100002413','005100016982','001410007231','005100019620','005100019621','005100020176','005100014653','005100015855','005100014655','004156516735','005100002373','005100027101','004156522743','005260309070','005260305601','005100024857','005100000203','005100000210','005100010061','005100014871','005100014916','005100021892','005100024718','005100024719','005100024720','005260306575','004156527682','004156527683','004156527684','004156527789','004156528078','004156528079','005100028009','005100028010','005260308325','005260306653','005260309505','005260309482','005260309483','005260309484','005260309461','005260309462','005260309463','005100019069','005100021399','005100012495')
  and date(fact.period) > date('2021-01-01')
  and store.holding_description = 'Target'

group by fact.store_tdlinx_id, fact.period

-- COMMAND ----------

select * from nielsenpos_store_sales_im.vw_dimension_store_tdlinx as store

-- COMMAND ----------

-- MAGIC %python
-- MAGIC dataframe = spark.sql("select fact.period, sum(float(fact.dollar_sales)) as dollar_sales, sum(fact.unit_sales), hier.brand_description, hier.category_description, hier.subcategory_description \
-- MAGIC \
-- MAGIC from nielsen_store_sales_im.fact_store_sales as fact\
-- MAGIC   inner join nielsen_store_sales_im.vw_dimension_item_hierarchy as hier on fact.upc = hier.upc \
-- MAGIC group by period, brand_description, category_description, subcategory_description")
